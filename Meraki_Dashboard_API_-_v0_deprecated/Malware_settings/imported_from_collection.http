#!/usr/bin/env dothttp

// Returns all supported malware settings for an MX network

@name("getNetworkSecurityMalwareSettings")
GET "https://{{baseUrl}}/networks/:networkId/security/malwareSettings"
"Accept": "*/*"



// Set the supported malware settings for an MX network
//  #### Body Parameters 
// **Parameter**|**Type**|**Description** 
//  :-------------: |:-------------: |:-------------: 
// mode| string| Set mode to 'enabled' to enable malware prevention, otherwise 'disabled'
// allowedUrls| array| The urls that should be permitted by the malware detection engine. If omitted, the current config will remain unchanged. This is available only if your network supports AMP whitelisting
// allowedFiles| array| The sha256 digests of files that should be permitted by the malware detection engine. If omitted, the current config will remain unchanged. This is available only if your network supports AMP whitelisting

@name("updateNetworkSecurityMalwareSettings")
PUT "https://{{baseUrl}}/networks/:networkId/security/malwareSettings"
"Accept": "*/*"
"Content-Type": "application/json"
json({
    "mode": "enabled",
    "allowedUrls": [
        {
            "url": "example.org",
            "comment": "allow example.org"
        },
        {
            "url": "help.com.au",
            "comment": "allow help.com.au"
        }
    ],
    "allowedFiles": [
        {
            "sha256": "e82c5f7d75004727e1f3b94426b9a11c8bc4c312a9170ac9a73abace40aef503",
            "comment": "allow ZIP file"
        }
    ]
})



